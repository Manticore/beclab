<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Integrator &mdash; beclab 0.1.0+dev documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0+dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="beclab 0.1.0+dev documentation" href="../index.html" />
    <link rel="next" title="BEC" href="bec.html" />
    <link rel="prev" title="Beclab" href="../index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bec.html" title="BEC"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Beclab"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">beclab 0.1.0+dev documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-beclab.integrator">
<span id="integrator"></span><h1>Integrator<a class="headerlink" href="#module-beclab.integrator" title="Permalink to this headline">¶</a></h1>
<p>This sub-package exposes low-level integrator API.
These objects make minimal assumptions about the actual equation being integrated.</p>
<div class="section" id="id1">
<h2>Integrator<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="beclab.integrator.Integrator">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Integrator</tt><big>(</big><em>thread</em>, <em>stepper</em>, <em>wiener=None</em>, <em>verbose=True</em>, <em>profile=False</em><big>)</big><a class="headerlink" href="#beclab.integrator.Integrator" title="Permalink to this definition">¶</a></dt>
<dd><p>A low-level integration class.
Integrates an equation of the form</p>
<div class="math">
\[dy(x, t) = S(x, y, t, dt, dW),\]</div>
<p>where <span class="math">\(y(x)\)</span> is a multi-dimensional state vector with the primary dimension
being the number of trajectories, and <span class="math">\(S\)</span> is a stepper function.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>thread</strong> &#8211; a Reikna <tt class="docutils literal"><span class="pre">Thread</span></tt> object.</li>
<li><strong>stepper</strong> &#8211; a <a class="reference internal" href="#beclab.integrator.Stepper" title="beclab.integrator.Stepper"><tt class="xref py py-class docutils literal"><span class="pre">Stepper</span></tt></a> object providing the function <span class="math">\(S\)</span>.</li>
<li><strong>wiener</strong> &#8211; a <a class="reference internal" href="#beclab.integrator.Wiener" title="beclab.integrator.Wiener"><tt class="xref py py-class docutils literal"><span class="pre">Wiener</span></tt></a> object that will be used to generate
Wiener process differentials <tt class="docutils literal"><span class="pre">dW</span></tt>.</li>
<li><strong>verbose</strong> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, some information about integration progress
will be printed to stdout.</li>
<li><strong>profile</strong> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, CPU-GPU synchronization will be performed
before each sample collection, allowing for accurate measurements
of sampler time consumption.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="beclab.integrator.Integrator.adaptive_step">
<tt class="descname">adaptive_step</tt><big>(</big><em>data_dev</em>, <em>t_start</em>, <em>t_sample</em>, <em>starting_steps=2</em>, <em>t_end=None</em>, <em>samplers=None</em>, <em>strong_convergence=None</em>, <em>weak_convergence=None</em>, <em>filters=None</em>, <em>display=None</em>, <em>steps_limit=16384</em><big>)</big><a class="headerlink" href="#beclab.integrator.Integrator.adaptive_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs an adaptive step integration that varies the time step to satisfy
the provided convergence criteria.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_dev</strong> &#8211; same as for <a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">fixed_step()</span></tt></a>.</li>
<li><strong>t_start</strong> &#8211; same as for <a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">fixed_step()</span></tt></a>.</li>
<li><strong>t_sample</strong> &#8211; time between samples.</li>
<li><strong>starting_steps</strong> &#8211; initial number of steps per sampling interval.
Must be a power of 2 and greater than 1.</li>
<li><strong>t_end</strong> &#8211; ending time.
If <tt class="docutils literal"><span class="pre">None</span></tt>, the integration will continue until one of the samplers
raises <a class="reference internal" href="#beclab.integrator.StopIntegration" title="beclab.integrator.StopIntegration"><tt class="xref py py-class docutils literal"><span class="pre">StopIntegration</span></tt></a>.</li>
<li><strong>samplers</strong> &#8211; same as for <a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">fixed_step()</span></tt></a>.</li>
<li><strong>filters</strong> &#8211; same as for <a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">fixed_step()</span></tt></a>.</li>
<li><strong>weak_convergence</strong> &#8211; a dictionary of correspondences between sampler names
and convergence thresholds.
The convergence will be estimated after each sampling interval
and the number of steps will be increased if it is above the threshold.
Convergence is calculated the same as in <a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">fixed_step()</span></tt></a>.</li>
<li><strong>strong_convergence</strong> &#8211; same as above, but for strong convergence.</li>
<li><strong>display</strong> &#8211; a list of sampler names or tuples <tt class="docutils literal"><span class="pre">(sampler_name,</span> <span class="pre">format_string)</span></tt>
specifying the values to be displayed during integration if <tt class="docutils literal"><span class="pre">verbose=True</span></tt>.
If none is specified, only the time will be shown.
<tt class="docutils literal"><span class="pre">format_string</span></tt> is a format specification from <tt class="docutils literal"><span class="pre">format</span></tt> method of the standard
string class.
For example, <tt class="docutils literal"><span class="pre">('energy',</span> <span class="pre">'.3f')</span></tt> will result in printing the mean value from the
<tt class="docutils literal"><span class="pre">'energy'</span></tt> sampler as <tt class="docutils literal"><span class="pre">'{energy:.3f'}.format(energy_mean)</span></tt>.</li>
<li><strong>steps_limit</strong> &#8211; maximum number of steps per sampling interval.
If the integrator cannot achieve the required convergence without exceeding
this number, an <a class="reference internal" href="#beclab.integrator.IntegrationError" title="beclab.integrator.IntegrationError"><tt class="xref py py-class docutils literal"><span class="pre">IntegrationError</span></tt></a> will be raised.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">same as for <a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">fixed_step()</span></tt></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="beclab.integrator.Integrator.fixed_step">
<tt class="descname">fixed_step</tt><big>(</big><em>data_dev</em>, <em>t_start</em>, <em>t_end</em>, <em>steps</em>, <em>samples=1</em>, <em>samplers=None</em>, <em>filters=None</em>, <em>weak_convergence=None</em>, <em>strong_convergence=None</em><big>)</big><a class="headerlink" href="#beclab.integrator.Integrator.fixed_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a fixed time step integration process.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data_dev</strong> &#8211; a Reikna <tt class="docutils literal"><span class="pre">Array</span></tt> with the initial state vector
(<strong>Warning:</strong> will be updated inplace).
Should be the same as the one passed to the <tt class="docutils literal"><span class="pre">stepper</span></tt> object used to
create this integrator.</li>
<li><strong>t_start</strong> &#8211; starting time.</li>
<li><strong>t_end</strong> &#8211; ending time.</li>
<li><strong>steps</strong> &#8211; number of steps to perform.</li>
<li><strong>samples</strong> &#8211; number of samples to collect (not including the sample at <tt class="docutils literal"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">t_start</span></tt>).
<tt class="docutils literal"><span class="pre">steps</span></tt> must be divisible by <tt class="docutils literal"><span class="pre">samples</span></tt>.</li>
<li><strong>samplers</strong> &#8211; a dictionary containing correspondences
(<tt class="docutils literal"><span class="pre">sampler_name</span></tt>, <tt class="docutils literal"><span class="pre">sampler</span></tt>), where <tt class="docutils literal"><span class="pre">sampler</span></tt> is a <a class="reference internal" href="#beclab.integrator.Sampler" title="beclab.integrator.Sampler"><tt class="xref py py-class docutils literal"><span class="pre">Sampler</span></tt></a> object.</li>
<li><strong>filters</strong> &#8211; a list with <a class="reference internal" href="#beclab.integrator.Filter" title="beclab.integrator.Filter"><tt class="xref py py-class docutils literal"><span class="pre">Filter</span></tt></a> objects that are applied to the data
array after each two normal steps, or after each double step.</li>
<li><strong>weak_convergence</strong> &#8211; a list of sampler names which will be used to estimate
weak convergence (a normalized 2-norm of the difference between the sampled mean values
during integration with normal and double time steps).</li>
<li><strong>strong_convergence</strong> &#8211; a list of sampler names which will be used to estimate
strong convergence (the maximum over trajectories of normalized 2-norms of differences
between the sampled values during integration with normal and double time steps).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>a tuple <tt class="docutils literal"><span class="pre">(results,</span> <span class="pre">info)</span></tt>, where <tt class="docutils literal"><span class="pre">info</span></tt> is a <a class="reference internal" href="#beclab.integrator.IntegrationInfo" title="beclab.integrator.IntegrationInfo"><tt class="xref py py-class docutils literal"><span class="pre">IntegrationInfo</span></tt></a>
object, and <tt class="docutils literal"><span class="pre">results</span></tt> is the data structure</p>
<div class="highlight-python"><div class="highlight"><pre>{sampler_name:
    {trajectories: int,
     time: array(samples + 1),
     mean: array(samples + 1, *sample_shape),
     values: array(samples + 1, trajectories, *sample_shape),
     stderr: array(samples + 1, *sample_shape)}, ...}
</pre></div>
</div>
<p>The existence of <tt class="docutils literal"><span class="pre">mean</span></tt>, <tt class="docutils literal"><span class="pre">values</span></tt> and <tt class="docutils literal"><span class="pre">stderr</span></tt> keys depends on
whether they were enabled by a particular sampler.</p>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="beclab.integrator.Sampler">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Sampler</tt><big>(</big><em>no_mean=False</em>, <em>no_stderr=False</em>, <em>no_values=False</em><big>)</big><a class="headerlink" href="#beclab.integrator.Sampler" title="Permalink to this definition">¶</a></dt>
<dd><p>A base class for a sampler.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>no_mean</strong> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, mean values will not be collected.</li>
<li><strong>no_stderr</strong> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, estimates of sampling errors will not be collected.</li>
<li><strong>no_values</strong> &#8211; if <tt class="docutils literal"><span class="pre">True</span></tt>, per-trajectory values will not be collected.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="beclab.integrator.Sampler.__call__">
<tt class="descname">__call__</tt><big>(</big><em>data</em>, <em>t</em><big>)</big><a class="headerlink" href="#beclab.integrator.Sampler.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>A callback method that will be invoked by the integrator
at every sampling point and passed the current data array
(<strong>warning:</strong> must not be modified; copy if necessary)
and the current integration time <tt class="docutils literal"><span class="pre">t</span></tt>.</p>
<p>Must return a scalar or a <tt class="docutils literal"><span class="pre">numpy</span></tt> array
(with the same dtype and dimensions for every call).
The first dimension must be equal to the number of trajectories.
Depending on the attributes set on creation,
the integrator will collect <tt class="docutils literal"><span class="pre">.mean(0)</span></tt>, <tt class="docutils literal"><span class="pre">.std(0)</span> <span class="pre">/</span> <span class="pre">sqrt(trajectories)</span></tt>
and the array itself as <tt class="docutils literal"><span class="pre">mean</span></tt>, <tt class="docutils literal"><span class="pre">stderr</span></tt> and <tt class="docutils literal"><span class="pre">values</span></tt> correspondingly
in the data structure returned from <a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">Integrator.fixed_step()</span></tt></a> and
<a class="reference internal" href="#beclab.integrator.Integrator.adaptive_step" title="beclab.integrator.Integrator.adaptive_step"><tt class="xref py py-meth docutils literal"><span class="pre">Integrator.adaptive_step()</span></tt></a>.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="beclab.integrator.Filter">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Filter</tt><a class="headerlink" href="#beclab.integrator.Filter" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class of a filter object used by <a class="reference internal" href="#beclab.integrator.Integrator" title="beclab.integrator.Integrator"><tt class="xref py py-class docutils literal"><span class="pre">Integrator</span></tt></a>.</p>
<dl class="method">
<dt id="beclab.integrator.Filter.__call__">
<tt class="descname">__call__</tt><big>(</big><em>data</em>, <em>t</em><big>)</big><a class="headerlink" href="#beclab.integrator.Filter.__call__" title="Permalink to this definition">¶</a></dt>
<dd><p>A callback method that will be invoked by the integrator
when the object is passed in the <tt class="docutils literal"><span class="pre">filters</span></tt> list to
<a class="reference internal" href="#beclab.integrator.Integrator.fixed_step" title="beclab.integrator.Integrator.fixed_step"><tt class="xref py py-meth docutils literal"><span class="pre">Integrator.fixed_step()</span></tt></a> or <a class="reference internal" href="#beclab.integrator.Integrator.adaptive_step" title="beclab.integrator.Integrator.adaptive_step"><tt class="xref py py-meth docutils literal"><span class="pre">Integrator.adaptive_step()</span></tt></a>.</p>
<p>The <tt class="docutils literal"><span class="pre">data</span></tt> array is a Reikna <tt class="docutils literal"><span class="pre">Array</span></tt> and is supposed to be modified inplace.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="steppers">
<h2>Steppers<a class="headerlink" href="#steppers" title="Permalink to this headline">¶</a></h2>
<p>Available steppers:</p>
<dl class="class">
<dt id="beclab.integrator.CDStepper">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">CDStepper</tt><a class="headerlink" href="#beclab.integrator.CDStepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Central difference semi-implicit stepper (<a class="reference external" href="http://dx.doi.org/doi:10.1006/jcph.1996.5638">Werner and Drummond, 1997</a>).</p>
</dd></dl>

<dl class="class">
<dt id="beclab.integrator.CDIPStepper">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">CDIPStepper</tt><a class="headerlink" href="#beclab.integrator.CDIPStepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Central difference semi-implicit stepper in the interaction picture.
Does not support momentum cutoffs at the moment.</p>
</dd></dl>

<dl class="class">
<dt id="beclab.integrator.RK4IPStepper">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">RK4IPStepper</tt><a class="headerlink" href="#beclab.integrator.RK4IPStepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Standard Runge-Kutta 4th order in the interaction picture (<a class="reference external" href="http://www.physics.otago.ac.nz/research/jackdodd/resources/ResourceFiles/Caradoc-Davies_PhD_thesis.pdf">Caradoc-Davies, 2000 (PhD thesis)</a>).</p>
</dd></dl>

<dl class="class">
<dt id="beclab.integrator.RK46NLStepper">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">RK46NLStepper</tt><a class="headerlink" href="#beclab.integrator.RK46NLStepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Low-dissipation and low-dispersion 4th order Runge-Kutta (<a class="reference external" href="http://dx.doi.org/doi:10.1016/j.compfluid.2005.04.003">Berland, Bogey and Bailly, 2006</a>).</p>
</dd></dl>

<dl class="class">
<dt id="beclab.integrator.Stepper">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Stepper</tt><big>(</big><em>shape</em>, <em>box</em>, <em>drift</em>, <em>trajectories=1</em>, <em>kinetic_coeff=0.5j</em>, <em>diffusion=None</em>, <em>ksquared_cutoff=None</em><big>)</big><a class="headerlink" href="#beclab.integrator.Stepper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="docutils literal"><span class="pre">reikna.core.Computation</span></tt></p>
<p>The base class of a stepper object used by <a class="reference internal" href="#beclab.integrator.Integrator" title="beclab.integrator.Integrator"><tt class="xref py py-class docutils literal"><span class="pre">Integrator</span></tt></a>.
Used to calculated the differential of the state vector given
time, time step and (optionally) Wiener process differentials:</p>
<div class="math">
\[S(x, y, t, dt, dW) = K \nabla^2 y + D(x, y, t) dt + S(x, y, t) dW,\]</div>
<p>where <span class="math">\(D\)</span> is the deterministic (drift) term,
and <span class="math">\(S\)</span> is the stochastic (diffusion) term.</p>
<p>This class assumes that the state vector is defined on a uniform rectangular grid,
and its shape is <tt class="docutils literal"><span class="pre">(trajectories,</span> <span class="pre">components,</span> <span class="pre">*shape)</span></tt>, where
the number of components is specified by <tt class="docutils literal"><span class="pre">drift</span></tt> and <tt class="docutils literal"><span class="pre">diffusion</span></tt> objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>shape</strong> &#8211; grid shape.</li>
<li><strong>box</strong> &#8211; the physical size of the grid.</li>
<li><strong>drift</strong> &#8211; a <a class="reference internal" href="#beclab.integrator.Drift" title="beclab.integrator.Drift"><tt class="xref py py-class docutils literal"><span class="pre">Drift</span></tt></a> object providing the function <span class="math">\(D\)</span>.</li>
<li><strong>trajectories</strong> &#8211; the number of stochastic trajectories.</li>
<li><strong>kinetic_coeff</strong> &#8211; the value of <span class="math">\(K\)</span> above (can be real or complex).</li>
<li><strong>diffusion</strong> &#8211; a <a class="reference internal" href="#beclab.integrator.Diffusion" title="beclab.integrator.Diffusion"><tt class="xref py py-class docutils literal"><span class="pre">Diffusion</span></tt></a> object providing the function <span class="math">\(S\)</span>.</li>
<li><strong>ksquared_cutoff</strong> &#8211; if a positive real value, will be used as a cutoff threshold
for <span class="math">\(k^2\)</span> in the momentum space.
The modes with higher momentum will be projected out on each step.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="beclab.integrator.Drift">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Drift</tt><big>(</big><em>module</em>, <em>dtype</em>, <em>components=1</em><big>)</big><a class="headerlink" href="#beclab.integrator.Drift" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class for drift (deterministic part of a stepper) modules.</p>
<p>The module must contain functions with the names and signatures</p>
<div class="highlight-python"><div class="highlight"><pre>INLINE WITHIN_KERNEL ${s_ctype} ${prefix}${component}(
        const int idx_x, ...
        const ${s_ctype} y0, ...
        ${r_ctype} t)
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">s_ctype</span></tt> is the C type corresponding to the state vector dtype,
and <tt class="docutils literal"><span class="pre">component</span></tt> is the number of component the function handles
(starting from 0).
First set of parameters is the index of the processed element in the grid
(total number is therefore the number of grid dimensions),
the second set is the value of the state vector with this index for every component.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>module</strong> &#8211; a Reikna <tt class="docutils literal"><span class="pre">Module</span></tt> object.</li>
<li><strong>dtype</strong> &#8211; the data type of a supported state vector.</li>
<li><strong>components</strong> &#8211; the number of components the module has functions for.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="beclab.integrator.Diffusion">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Diffusion</tt><big>(</big><em>module</em>, <em>dtype</em>, <em>components=1</em>, <em>noise_sources=1</em>, <em>real_noise=False</em><big>)</big><a class="headerlink" href="#beclab.integrator.Diffusion" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class for diffusion (stochastic part of a stepper) modules.</p>
<p>The module must contain functions with the names and signatures</p>
<div class="highlight-python"><div class="highlight"><pre>INLINE WITHIN_KERNEL ${s_ctype} ${prefix}${component}_${noise_source}(
    const int idx_x, ...
    const ${s_ctype} y0, ...
    ${r_ctype} t)
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">s_ctype</span></tt> is the C type corresponding to the state vector dtype,
<tt class="docutils literal"><span class="pre">component</span></tt> and <tt class="docutils literal"><span class="pre">noise_source</span></tt> are the number of component and the number of noise source
the function handles, respectively (starting from 0).
The parameters are the same as for <a class="reference internal" href="#beclab.integrator.Drift" title="beclab.integrator.Drift"><tt class="xref py py-class docutils literal"><span class="pre">Drift</span></tt></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>module</strong> &#8211; a Reikna <tt class="docutils literal"><span class="pre">Module</span></tt> object.</li>
<li><strong>dtype</strong> &#8211; the data type of a supported state vector.</li>
<li><strong>components</strong> &#8211; the number of components the module has functions for.</li>
<li><strong>noise_sources</strong> &#8211; the number of noise sources the module has functions for.</li>
<li><strong>real_noise</strong> &#8211; whether the stochastic term uses a real-valued Wiener process.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="wiener-process">
<h2>Wiener process<a class="headerlink" href="#wiener-process" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="beclab.integrator.Wiener">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Wiener</tt><big>(</big><em>noise_arr</em>, <em>normalization</em>, <em>seed=None</em><big>)</big><a class="headerlink" href="#beclab.integrator.Wiener" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="docutils literal"><span class="pre">reikna.core.Computation</span></tt></p>
<p>Samples a set of differentials <span class="math">\(dw_i\)</span> for independent standard
real- or complex-valued Wiener processes <span class="math">\(w_i(t)\)</span>, such that</p>
<div class="math">
\[\langle dw_i dw_j^* \rangle = C \delta_{ij} dt,\]</div>
<p>where <span class="math">\(C\)</span> is the normalization coefficient and <span class="math">\(dt\)</span> is the time step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>noise_arr</strong> &#8211; an array-like object, which will be filled with samples
on each computation call.
Can have a real or a complex <tt class="docutils literal"><span class="pre">dtype</span></tt>.</li>
<li><strong>normalization</strong> &#8211; the normalization coefficient <span class="math">\(C\)</span> in the equation above.</li>
<li><strong>seed</strong> &#8211; a seed for the RNG.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="beclab.integrator.Wiener.compiled_signature">
<tt class="descname">compiled_signature</tt><big>(</big><em>state:io</em>, <em>dW:o</em>, <em>dt:s</em><big>)</big><a class="headerlink" href="#beclab.integrator.Wiener.compiled_signature" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>state</strong> &#8211; an array containing the current RNG state.</li>
<li><strong>dW</strong> &#8211; an array with the shape and dtype of <tt class="docutils literal"><span class="pre">noise_arr</span></tt>,
where differentials will be written on each call.</li>
<li><strong>dt</strong> &#8211; a scalar with the value of the time step.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>A functional Wiener process W(x,t) on a regular grid is</p>
<div class="math">
\[W(x,t) = \sum_{n \in B} \phi_n w_n(t),\]</div>
<p>which has the correlations</p>
<div class="math">
\[\langle dW(x, t) dW^*(x', t) \rangle = \delta(x - x') dt.\]</div>
<p>where <span class="math">\(B\)</span> is the full basis set, <span class="math">\(\phi_n\)</span> are orthonormal basis modes,
and <span class="math">\(w_n(t)\)</span> are single-mode standard Wiener processes.
For a rectangular uniform grid it is equivalent to</p>
<div class="math">
\[W(x, t) = w_x(t) / \sqrt{dV},\quad x \in \mathrm{grid},\]</div>
<p class="last">where <span class="math">\(dV\)</span> is the volume of a grid cell.
Therefore differentials <span class="math">\(dW(x,t)\)</span> of a functional Wiener process
can be sampled with this computation by setting
<tt class="docutils literal"><span class="pre">normalization</span></tt> to <tt class="docutils literal"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">sqrt(dV)</span></tt>.</p>
</div>
</dd></dl>

</div>
<div class="section" id="helper-classes">
<h2>Helper classes<a class="headerlink" href="#helper-classes" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="beclab.integrator.IntegrationInfo">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">IntegrationInfo</tt><big>(</big><em>timings</em>, <em>strong_errors</em>, <em>weak_errors</em>, <em>steps</em><big>)</big><a class="headerlink" href="#beclab.integrator.IntegrationInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains auxiliary information about integration.</p>
<dl class="attribute">
<dt id="beclab.integrator.IntegrationInfo.weak_errors">
<tt class="descname">weak_errors</tt><a class="headerlink" href="#beclab.integrator.IntegrationInfo.weak_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary matching sampler names to weak convergence estimates.</p>
</dd></dl>

<dl class="attribute">
<dt id="beclab.integrator.IntegrationInfo.strong_errors">
<tt class="descname">strong_errors</tt><a class="headerlink" href="#beclab.integrator.IntegrationInfo.strong_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>A dictionary matching sampler names to strong convergence estimates.</p>
</dd></dl>

<dl class="attribute">
<dt id="beclab.integrator.IntegrationInfo.timings">
<tt class="descname">timings</tt><a class="headerlink" href="#beclab.integrator.IntegrationInfo.timings" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#beclab.integrator.Timings" title="beclab.integrator.Timings"><tt class="xref py py-class docutils literal"><span class="pre">Timings</span></tt></a> object.</p>
</dd></dl>

<dl class="attribute">
<dt id="beclab.integrator.IntegrationInfo.steps">
<tt class="descname">steps</tt><a class="headerlink" href="#beclab.integrator.IntegrationInfo.steps" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of steps used for the integration.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="beclab.integrator.Timings">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">Timings</tt><big>(</big><em>normal=0</em>, <em>double=0</em>, <em>samplers=0</em><big>)</big><a class="headerlink" href="#beclab.integrator.Timings" title="Permalink to this definition">¶</a></dt>
<dd><p>Contains timings for various parts of the integration (in seconds).
Has an overloaded <tt class="docutils literal"><span class="pre">+</span></tt> operator.</p>
<dl class="attribute">
<dt id="beclab.integrator.Timings.samplers">
<tt class="descname">samplers</tt><a class="headerlink" href="#beclab.integrator.Timings.samplers" title="Permalink to this definition">¶</a></dt>
<dd><p>Time taken by samplers.</p>
</dd></dl>

<dl class="attribute">
<dt id="beclab.integrator.Timings.normal">
<tt class="descname">normal</tt><a class="headerlink" href="#beclab.integrator.Timings.normal" title="Permalink to this definition">¶</a></dt>
<dd><p>Time taken by normal step integration.</p>
</dd></dl>

<dl class="attribute">
<dt id="beclab.integrator.Timings.double">
<tt class="descname">double</tt><a class="headerlink" href="#beclab.integrator.Timings.double" title="Permalink to this definition">¶</a></dt>
<dd><p>Time taken by double step integration.</p>
</dd></dl>

<dl class="attribute">
<dt id="beclab.integrator.Timings.integration">
<tt class="descname">integration</tt><a class="headerlink" href="#beclab.integrator.Timings.integration" title="Permalink to this definition">¶</a></dt>
<dd><p>Total time taken by normal and double step integration.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="beclab.integrator.StopIntegration">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">StopIntegration</tt><a class="headerlink" href="#beclab.integrator.StopIntegration" title="Permalink to this definition">¶</a></dt>
<dd><p>If raised by a <a class="reference internal" href="#beclab.integrator.Sampler" title="beclab.integrator.Sampler"><tt class="xref py py-class docutils literal"><span class="pre">Sampler</span></tt></a> object, stops the <a class="reference internal" href="#beclab.integrator.Integrator" title="beclab.integrator.Integrator"><tt class="xref py py-class docutils literal"><span class="pre">Integrator</span></tt></a>.</p>
</dd></dl>

<dl class="class">
<dt id="beclab.integrator.IntegrationError">
<em class="property">class </em><tt class="descclassname">beclab.integrator.</tt><tt class="descname">IntegrationError</tt><a class="headerlink" href="#beclab.integrator.IntegrationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised by <a class="reference internal" href="#beclab.integrator.Integrator" title="beclab.integrator.Integrator"><tt class="xref py py-class docutils literal"><span class="pre">Integrator</span></tt></a> in case of various integration-time errors.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Integrator</a><ul>
<li><a class="reference internal" href="#id1">Integrator</a></li>
<li><a class="reference internal" href="#steppers">Steppers</a></li>
<li><a class="reference internal" href="#wiener-process">Wiener process</a></li>
<li><a class="reference internal" href="#helper-classes">Helper classes</a></li>
<li><a class="reference internal" href="#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../index.html"
                        title="previous chapter">Beclab</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="bec.html"
                        title="next chapter">BEC</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/integrator.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="bec.html" title="BEC"
             >next</a> |</li>
        <li class="right" >
          <a href="../index.html" title="Beclab"
             >previous</a> |</li>
        <li><a href="../index.html">beclab 0.1.0+dev documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Bogdan Opanchuk.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.1.
    </div>
  </body>
</html>